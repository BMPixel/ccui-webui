You are tasked to create a webui for the claude code (cc for short) cli (CCUI). CC is a code agent tool live in command line that brings up an interactive chat conversation flow with the user. CC has provided streaming jsonl responses and programmatic invoking, so that a webui binding for managing cc and interact with cc will be welcome by some user who prefer more portable and refined experience.

Please refer to [https://docs.anthropic.com/en/docs/claude-code/cli-usage](https://docs.anthropic.com/en/docs/claude-code/cli-usage) and [https://docs.anthropic.com/en/docs/claude-code/sdk](https://docs.anthropic.com/en/docs/claude-code/sdk) to understand cc sdk. [https://github.com/anthropics/anthropic-sdk-typescript/blob/main/src/resources/messages/messages.ts](https://github.com/anthropics/anthropic-sdk-typescript/blob/main/src/resources/messages/messages.ts) provides more information for Message spec.

First you should research and think hard for a clean, reasonable plan for implement the "connector" part for the project. You need to implement following features:

- ccui starts node server that can invoke `claude` cli tool at any directory given rest api request. CC will streaming its output in jsonl sequence with a unique session id for each newly started conversation. ccui will parse and stream the flows back to user until the cc command ends.
- ccui will turn the cc global history at `~/.claude` into several api endpoint that expose the conversation history to the frontend, so the user can browse between different conversation and action on them. The example structure of the `~/.claude` folder has been provide here
    - `list_conversations` will list all conversations by session id, with their date and summary
    - `fetch_conversation` will return jsonl of given session id
- ccui can handle the tool permission interactively by using an custom mcp as showed in the cc sdk. The mcp server will send a tool permission request (with session id) to the ccui. ccui maintains a list of ongoing permssion requests exposing the list with an api, and and api endpoint is able to accept/deny any permissions.

You need to produce a detailed implementation plan for the backend, including 1) the framework, toolchain, and logic flow of the best design, 2) a full api schema 3) how each feature (including the mcp) is going to be implemented. Do going into actual process of implement key feature and how they are going to interact with other features. Do NOT write any actual logic code in the plan. Focus on the code part instead of performance, time schedule etc. Before writng the plan, research and think hard carefully to collect enough information.